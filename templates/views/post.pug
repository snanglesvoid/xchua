extends ../layouts/layout

block intro
  if data.post
    div(data-ks-editable=editable(user, { list: 'Post', id: data.post.id }))
      h2= data.post.title[lang] || data.post.title.english

block content
  .page: .scrollpane: .scrollpane-content: .row: .col-sm-10.col-sm-offset-1.col-md-8.col-md-offset-2
    article
      //- p: a(href='/blog') &larr; back to the blog
      //- hr
      if !data.post
        h2 Invalid Post.
      else
        .post
          if data.post.image.exists
            .image-wrap: img(src=data.post._.image.fit(750,450)).img-responsive
          div(
            style="position: relative;",
          )
            div(
              style="position: relative;",
              data-editable= inlineEditable(user, {
                list: 'posts',
                path: 'content.' + (lang || 'english') + '.extended',
                data: JSON.stringify(data.post)
              })
            )!= (data.post.content[lang] || data.post.content.english).full
        //- header
          h1= data.post.title[lang] || data.post.english
          h5 Posted 
            if data.post.publishedDate
              | on #{data.post._.publishedDate.format('MMMM Do, YYYY')} 
            if data.post.categories && data.post.categories.length
              | in 
              each cat, cat_i in data.post.categories
                a(href='/blog/' + cat.key)= cat.name[lang] || cat.name.english
                if cat_i < data.post.categories.length - 1
                  | , 
                else
                  |  
            if data.post.author
              | by #{data.post.author.name.first}
